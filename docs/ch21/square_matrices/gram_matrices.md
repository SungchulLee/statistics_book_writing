# Gram Matrices

## Definition: Gram Matrix $\mathbf{G}$ of $\mathbf{X}$

For an $n \times k$ matrix $\mathbf{X}$, the **Gram matrix** $\mathbf{G}$ is defined as:

$$
\mathbf{G} = \mathbf{X}^T \mathbf{X}
$$

where $\mathbf{G}$ is a **$k \times k$** matrix that contains all possible inner products between the columns of $\mathbf{X}$. Specifically, the entry $g_{ij}$ of $\mathbf{G}$ is given by:

$$
g_{ij} = \mathbf{x}_i^T \mathbf{x}_j
$$

## Theorem: Rank of Gram Matrix

!!! info "Theorem"
    $$\text{rank}(\mathbf{G})=\text{rank}(\mathbf{X})$$

??? note "Proof"
    **Rank of $\mathbf{G}$ Cannot Exceed Rank of $\mathbf{X}$.** Consider the Gram matrix $\mathbf{G} = \mathbf{X}^T \mathbf{X}$, which is a $k \times k$ symmetric matrix. The rank of a product of two matrices cannot exceed the rank of either matrix:

    $$
    \text{rank}(\mathbf{G}) = \text{rank}(\mathbf{X}^T \mathbf{X}) \leq \min(\text{rank}(\mathbf{X}^T), \text{rank}(\mathbf{X})) = \text{rank}(\mathbf{X})
    $$

    **Full Column Rank of $\mathbf{X}$ Implies Full Rank of $\mathbf{G}$.** The Gram matrix $\mathbf{G} = \mathbf{X}^T \mathbf{X}$ is **positive definite** if the columns of $\mathbf{X}$ are linearly independent. For any non-zero vector $\mathbf{v} \in \mathbb{R}^k$:

    $$
    \mathbf{v}^T (\mathbf{X}^T \mathbf{X}) \mathbf{v} = (\mathbf{X} \mathbf{v})^T (\mathbf{X} \mathbf{v}) = \|\mathbf{X} \mathbf{v}\|^2 > 0
    $$

    Since $\mathbf{G}$ is positive definite, it is invertible and hence has rank $k$.

    **Full Rank of $\mathbf{G}$ Implies Full Column Rank of $\mathbf{X}$.** If $\text{rank}(\mathbf{G})=k$, then $\text{rank}(\mathbf{X})\ge k$ and hence $\text{rank}(\mathbf{X})= k$.

    **Rank Equality.** If $\mathbf{X}$ does not have full column rank, we concentrate on the linearly independent columns and ignore dependent columns. If there are $c$ independent columns, $\mathbf{G}$ has portions generated by these independent columns. So the rank of $\mathbf{G}$ is at least $c$, and it cannot exceed $c$. Therefore, both ranks equal $c$.

## Theorem: Invertibility of Gram Matrix

!!! info "Theorem"
    For an $n \times k$ matrix $\mathbf{X}$, the Gram matrix $\mathbf{G}$ is invertible if and only if $\text{rank}(\mathbf{G})=k$ if and only if $\mathbf{X}$ has full column rank, meaning all the columns of $\mathbf{X}$ are linearly independent. This follows from the rank identity above.

## Gram Matrix When $\mathbf{X}$ Has Full Column Rank

When $\mathbf{X}$ has full column rank:

- The Gram matrix $\mathbf{G} = \mathbf{X}^T \mathbf{X}$ is **invertible**.
- The Gram matrix $\mathbf{G}$ is **positive definite**.
- The inverse of the Gram matrix, $(\mathbf{X}^T \mathbf{X})^{-1}$, is well-defined, which plays an important role in many applications, such as finding the **least squares solution** in linear regression.
